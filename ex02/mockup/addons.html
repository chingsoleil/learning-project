<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âä†Ë≥ºËàáÂåÖË£ù - ÈªûÈ§êÁ≥ªÁµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    maxWidth: {
                        'mobile': '480px'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">
    <!-- ‰∏ªÂÆπÂô® -->
    <div class="mx-auto max-w-mobile min-h-screen bg-white shadow-lg">
        <!-- Ê®ôÈ°åÂàó -->
        <header class="bg-blue-600 text-white p-4">
            <h1 class="text-lg font-semibold">Âä†Ë≥ºËàáÂåÖË£ù</h1>
            <div class="text-sm mt-1 opacity-90">Ê≠•È©ü 6/9 ¬∑ Âè∞Âåó‰ø°Áæ©Â∫ó ¬∑ Â§ñÂ∏∂</div>
        </header>

        <!-- ÈÄ≤Â∫¶Ê¢ù -->
        <div class="bg-gray-200 h-2">
            <div class="bg-blue-600 h-2 transition-all duration-300" style="width: 66.6%"></div>
        </div>

        <!-- ÂÖßÂÆπÂçÄ -->
        <main class="pb-20">
            <!-- ÂåÖË£ùÈÅ∏Êìá -->
            <div class="p-4">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">ÂåÖË£ùÈÅ∏Êìá</h2>
                <p class="text-sm text-gray-600 mb-4">Â§ñÂ∏∂Âª∫Ë≠∞ÈÅ∏ÊìáÈÅ©Áï∂ÂåÖË£ùÔºåÁ¢∫‰øùÈ§êÈªûÂÆåÊï¥ÈÄÅÈÅî</p>
                
                <div class="space-y-3">
                    <!-- ÁÑ°ÂåÖË£ù -->
                    <label class="block">
                        <input type="radio" name="packaging" value="NONE" class="sr-only" onchange="selectPackaging('NONE', 0)">
                        <div class="border-2 border-blue-500 bg-blue-50 rounded-lg p-4 cursor-pointer hover:border-blue-600 transition-all" id="packaging-NONE">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-blue-600 rounded-full mr-3 flex items-center justify-center">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full"></div>
                                    </div>
                                    <div>
                                        <h3 class="font-medium text-gray-900">ÁÑ°ÂåÖË£ù</h3>
                                        <p class="text-sm text-gray-600">Áí∞‰øùÈÅ∏ÊìáÔºåÁèæÂ†¥‰∫´Áî®</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-lg font-semibold text-green-600">ÂÖçË≤ª</div>
                                    <div class="text-2xl">üå±</div>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- È§êÂÖ∑ -->
                    <label class="block">
                        <input type="radio" name="packaging" value="CUTLERY" class="sr-only" onchange="selectPackaging('CUTLERY', 5)">
                        <div class="border-2 border-gray-200 rounded-lg p-4 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all" id="packaging-CUTLERY">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full hidden"></div>
                                    </div>
                                    <div>
                                        <h3 class="font-medium text-gray-900">È§êÂÖ∑ÁµÑ</h3>
                                        <p class="text-sm text-gray-600">Áí∞‰øùÈ§êÂÖ∑„ÄÅÊøïÁ¥ôÂ∑æ</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-lg font-semibold text-blue-600">+$5</div>
                                    <div class="text-2xl">üç¥</div>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- Â∞èÊèêË¢ã -->
                    <label class="block">
                        <input type="radio" name="packaging" value="BAG_SMALL" class="sr-only" onchange="selectPackaging('BAG_SMALL', 8)">
                        <div class="border-2 border-gray-200 rounded-lg p-4 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all" id="packaging-BAG_SMALL">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full hidden"></div>
                                    </div>
                                    <div>
                                        <h3 class="font-medium text-gray-900">Â∞èÊèêË¢ã</h3>
                                        <p class="text-sm text-gray-600">ÈÅ©Âêà 1-2 ÂÄãÈ§êÁõí</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-lg font-semibold text-blue-600">+$8</div>
                                    <div class="text-2xl">üõçÔ∏è</div>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- ‰∏≠ÊèêË¢ã -->
                    <label class="block">
                        <input type="radio" name="packaging" value="BAG_MEDIUM" class="sr-only" onchange="selectPackaging('BAG_MEDIUM', 12)">
                        <div class="border-2 border-gray-200 rounded-lg p-4 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all" id="packaging-BAG_MEDIUM">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full hidden"></div>
                                    </div>
                                    <div>
                                        <h3 class="font-medium text-gray-900">‰∏≠ÊèêË¢ã</h3>
                                        <p class="text-sm text-gray-600">ÈÅ©Âêà 3-4 ÂÄãÈ§êÁõí</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-lg font-semibold text-blue-600">+$12</div>
                                    <div class="text-2xl">üõçÔ∏è</div>
                                </div>
                            </div>
                        </div>
                    </label>

                    <!-- Â§ßÊèêË¢ã -->
                    <label class="block">
                        <input type="radio" name="packaging" value="BAG_LARGE" class="sr-only" onchange="selectPackaging('BAG_LARGE', 18)">
                        <div class="border-2 border-gray-200 rounded-lg p-4 cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all" id="packaging-BAG_LARGE">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-gray-300 rounded-full mr-3 flex items-center justify-center">
                                        <div class="w-3 h-3 bg-blue-600 rounded-full hidden"></div>
                                    </div>
                                    <div>
                                        <h3 class="font-medium text-gray-900">Â§ßÊèêË¢ã</h3>
                                        <p class="text-sm text-gray-600">ÈÅ©Âêà 5 ÂÄã‰ª•‰∏äÈ§êÁõí</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-lg font-semibold text-blue-600">+$18</div>
                                    <div class="text-2xl">üõçÔ∏è</div>
                                </div>
                            </div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Êé®Ëñ¶Âä†Ë≥º -->
            <div class="px-4 pb-4">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Êé®Ëñ¶Âä†Ë≥º</h2>
                <div class="grid gap-3">
                    <!-- ËñØÊ¢ù -->
                    <div class="border border-gray-200 rounded-lg p-3 flex items-center justify-between">
                        <div class="flex items-center">
                            <img src="https://placehold.co/60x60/e5e7eb/6b7280?text=ËñØÊ¢ù" alt="ËñØÊ¢ù" class="w-12 h-12 rounded-lg object-cover mr-3">
                            <div>
                                <h3 class="font-medium text-gray-900">ËñØÊ¢ù</h3>
                                <p class="text-sm text-gray-600">ÈáëÈªÉÈÖ•ËÑÜ</p>
                                <p class="text-sm font-semibold text-blue-600">$40</p>
                            </div>
                        </div>
                        <button class="px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors text-sm" onclick="addToCart('21', 'ËñØÊ¢ù', 40)">
                            Âä†Ë≥º
                        </button>
                    </div>

                    <!-- ÈõûÁøÖ -->
                    <div class="border border-gray-200 rounded-lg p-3 flex items-center justify-between">
                        <div class="flex items-center">
                            <img src="https://placehold.co/60x60/e5e7eb/6b7280?text=ÈõûÁøÖ" alt="ÈõûÁøÖ" class="w-12 h-12 rounded-lg object-cover mr-3">
                            <div>
                                <h3 class="font-medium text-gray-900">ÈõûÁøÖ</h3>
                                <p class="text-sm text-gray-600">È¶ôÂ´©Â§öÊ±Å</p>
                                <p class="text-sm font-semibold text-blue-600">$55</p>
                            </div>
                        </div>
                        <button class="px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors text-sm" onclick="addToCart('22', 'ÈõûÁøÖ', 55)">
                            Âä†Ë≥º
                        </button>
                    </div>

                    <!-- ÁÜ±ÊπØ -->
                    <div class="border border-gray-200 rounded-lg p-3 flex items-center justify-between">
                        <div class="flex items-center">
                            <img src="https://placehold.co/60x60/e5e7eb/6b7280?text=ÊπØ" alt="ÁÜ±ÊπØ" class="w-12 h-12 rounded-lg object-cover mr-3">
                            <div>
                                <h3 class="font-medium text-gray-900">ÁÜ±ÊπØ</h3>
                                <p class="text-sm text-gray-600">ÊöñËÉÉÂ•ΩÈÅ∏Êìá</p>
                                <p class="text-sm font-semibold text-blue-600">$30</p>
                            </div>
                        </div>
                        <button class="px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors text-sm" onclick="addToCart('23', 'ÁÜ±ÊπØ', 30)">
                            Âä†Ë≥º
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ë®ÇÂñÆÊëòË¶Å -->
            <div class="px-4 pb-4">
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">Ë®ÇÂñÆÊëòË¶Å</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-600">È§êÈªûÂ∞èË®à</span>
                            <span class="font-medium" id="itemsSubtotal">$200</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ÂåÖË£ùË≤ª</span>
                            <span class="font-medium" id="packagingFee">$0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ÊäòÊâ£</span>
                            <span class="font-medium text-green-600" id="discount">-$0</span>
                        </div>
                        <div class="border-t border-gray-300 pt-2 mt-2">
                            <div class="flex justify-between">
                                <span class="text-lg font-semibold text-gray-900">Êáâ‰ªòÁ∏ΩÈ°ç</span>
                                <span class="text-lg font-bold text-blue-600" id="totalAmount">$200</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Â∫ïÈÉ®Â∞éË¶Ω -->
        <footer class="fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-mobile bg-white border-t border-gray-200 p-4">
            <div class="flex gap-3">
                <button class="flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors" onclick="goBack()">
                    ËøîÂõû
                </button>
                <button class="flex-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors" onclick="proceedToPickup()">
                    ‰∏ã‰∏ÄÊ≠•
                </button>
                <button class="px-4 py-3 text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors" onclick="goToStoreSelect()">
                    üè†
                </button>
            </div>
        </footer>
    </div>

    <script>
        let selectedPackaging = 'NONE';
        let packagingFee = 0;
        let orderSummary = {};

        // ÂàùÂßãÂåñÈ†ÅÈù¢
        document.addEventListener('DOMContentLoaded', function() {
            loadOrderSummary();
            updateSummary();
        });

        function loadOrderSummary() {
            orderSummary = JSON.parse(sessionStorage.getItem('orderSummary') || '{"subtotal":200,"discountTotal":0,"grandTotal":200}');
        }

        function selectPackaging(type, fee) {
            selectedPackaging = type;
            packagingFee = fee;

            // ÈáçÁΩÆÊâÄÊúâÂåÖË£ùÈÅ∏È†ÖÊ®£Âºè
            document.querySelectorAll('[id^="packaging-"]').forEach(option => {
                option.classList.remove('border-blue-500', 'bg-blue-50');
                option.classList.add('border-gray-200');
                
                const radio = option.querySelector('.w-6 > div');
                const radioContainer = option.querySelector('.w-6');
                radio.classList.add('hidden');
                radioContainer.classList.remove('border-blue-600');
                radioContainer.classList.add('border-gray-300');
            });

            // Ë®≠ÂÆöÈÅ∏‰∏≠ÁöÑÂåÖË£ùÊ®£Âºè
            const selectedOption = document.getElementById(`packaging-${type}`);
            selectedOption.classList.remove('border-gray-200');
            selectedOption.classList.add('border-blue-500', 'bg-blue-50');
            
            const selectedRadio = selectedOption.querySelector('.w-6 > div');
            const selectedRadioContainer = selectedOption.querySelector('.w-6');
            selectedRadio.classList.remove('hidden');
            selectedRadioContainer.classList.remove('border-gray-300');
            selectedRadioContainer.classList.add('border-blue-600');

            updateSummary();
        }

        function addToCart(productId, productName, price) {
            // Á∞°ÂñÆÁöÑÂä†Ë≥ºÂäüËÉΩ
            const cart = JSON.parse(sessionStorage.getItem('cart') || '[]');
            cart.push({
                productId: productId,
                productName: productName,
                unitPrice: price,
                quantity: 1,
                options: {},
                customNote: '',
                lineTotal: price
            });
            sessionStorage.setItem('cart', JSON.stringify(cart));

            // Êõ¥Êñ∞Ë®ÇÂñÆÊëòË¶Å
            orderSummary.subtotal += price;
            orderSummary.grandTotal = orderSummary.subtotal - orderSummary.discountTotal + packagingFee;
            sessionStorage.setItem('orderSummary', JSON.stringify(orderSummary));

            updateSummary();

            // Ë¶ñË¶∫ÂõûÈ•ã
            event.target.textContent = 'Â∑≤Âä†Ë≥º';
            event.target.disabled = true;
            event.target.classList.add('bg-green-100', 'text-green-700', 'border-green-300');
            
            setTimeout(() => {
                event.target.textContent = 'Âä†Ë≥º';
                event.target.disabled = false;
                event.target.classList.remove('bg-green-100', 'text-green-700', 'border-green-300');
            }, 1500);
        }

        function updateSummary() {
            const itemsSubtotal = orderSummary.subtotal || 200;
            const discount = orderSummary.discountTotal || 0;
            const total = itemsSubtotal - discount + packagingFee;

            document.getElementById('itemsSubtotal').textContent = `$${itemsSubtotal}`;
            document.getElementById('packagingFee').textContent = `$${packagingFee}`;
            document.getElementById('discount').textContent = discount > 0 ? `-$${discount}` : '$0';
            document.getElementById('totalAmount').textContent = `$${total}`;
        }

        function proceedToPickup() {
            // ÂÑ≤Â≠òÂåÖË£ùÈÅ∏Êìá
            const packagingInfo = {
                packagingOption: selectedPackaging,
                packagingFee: packagingFee
            };
            sessionStorage.setItem('packagingInfo', JSON.stringify(packagingInfo));

            // Êõ¥Êñ∞Ë®ÇÂñÆÊëòË¶Å
            orderSummary.packagingFee = packagingFee;
            orderSummary.grandTotal = orderSummary.subtotal - orderSummary.discountTotal + packagingFee;
            sessionStorage.setItem('orderSummary', JSON.stringify(orderSummary));

            window.location.href = 'pickup.html';
        }

        function goBack() {
            window.location.href = 'cart.html';
        }

        function goToStoreSelect() {
            window.location.href = 'store-select.html';
        }
    </script>
</body>
</html>
