# 測驗 1：大五人格快速評估（BigFive Quick Assessment）

## 測驗基本資訊

| 欄位 | 值 | 說明 |
|------|-----|------|
| Name | 大五人格快速評估 | 測驗名稱 |
| Code | BIG5_QUICK_01 | 測驗代碼（唯一） |
| Description | 全面評估五大人格特質，適合一般人格評估、個人成長、職業規劃 | 測驗說明 |
| ResponseType | Likert5 | 作答方式：5點量表（1=非常不同意，2=不同意，3=普通，4=同意，5=非常同意） |
| TimeLimit | 20 | 作答時間限制（分鐘） |
| TotalQuestions | 50 | 總題數 |
| IsActive | 1 | 是否啟用 |

## 使用的 Instruments

- **Goldberg1999** (InstrumentCategoryId: 17) - Goldberg大五人格量表
- **NEO** (InstrumentCategoryId: 26) - NEO人格量表

**選題說明**：從這兩個 instruments 中選題，如果題目不足，可從其他大五相關 instruments 補充（如 BFAS, AB5C 等）

## 使用的 Traits

| Trait | TraitCategoryId | 目標題數 | 說明 |
|-------|----------------|---------|------|
| Extraversion（外向性） | 64 | 10題 | 社交性、活力、積極性 |
| Agreeableness（親和性） | 8 | 10題 | 同理心、合作性、信任 |
| Conscientiousness（盡責性） | 34 | 10題 | 責任感、組織性、自律 |
| Neuroticism（神經質） | 156 | 10題 | 情緒穩定性、焦慮、憂鬱 |
| Openness To Experience（開放性） | 162 | 10題 | 想像力、創造力、好奇心 |

**總計**：50題（每個 trait 各 10 題）

## 選題條件

1. **InstrumentCategoryId** IN (17, 26) - 優先選擇，如果不足可擴展到其他大五相關 instruments
2. **TraitCategoryId** IN (64, 8, 34, 156, 162)
3. **Alpha >= 0.70** - 優先選擇 Alpha >= 0.75 的題目
4. **IsActive = 1**
5. **平衡性**：每個 trait 的正向題（ScoringKey=1）約 6-7 題，反向題（ScoringKey=-1）約 3-4 題

## 題目清單

**注意**：以下題目為範例格式，實際選題時需從 QuestionBank.csv 中篩選符合條件的題目填入。

| 順序 | QuestionBankId | 題目文字 | TraitId | Trait名稱 | InstrumentId | Instrument名稱 | Alpha | ScoringKey | IsRequired |
|------|----------------|---------|---------|----------|-------------|---------------|-------|-----------|-----------|
| 1 | [待填入] | [從題庫選題] | 64 | Extraversion | 17或26 | Goldberg1999或NEO | >=0.70 | 1或-1 | 1 |
| 2 | [待填入] | [從題庫選題] | 8 | Agreeableness | 17或26 | Goldberg1999或NEO | >=0.70 | 1或-1 | 1 |
| ... | ... | ... | ... | ... | ... | ... | ... | ... | ... |
| 50 | [待填入] | [從題庫選題] | 162 | Openness To Experience | 17或26 | Goldberg1999或NEO | >=0.70 | 1或-1 | 1 |

### 選題 SQL 查詢範例

```sql
-- 查詢 Extraversion 題目（Goldberg1999 或 NEO）
SELECT 
    qb.Id AS QuestionBankId,
    qb.TextZh,
    qb.Alpha,
    qb.ScoringKey,
    ic.NameZh AS InstrumentName,
    tc.NameZh AS TraitName
FROM QuestionBank qb
INNER JOIN InstrumentCategory ic ON qb.InstrumentCategoryId = ic.Id
INNER JOIN TraitCategory tc ON qb.TraitCategoryId = tc.Id
WHERE qb.InstrumentCategoryId IN (17, 26)  -- Goldberg1999, NEO
  AND qb.TraitCategoryId = 64               -- Extraversion
  AND qb.Alpha >= 0.70
  AND qb.IsActive = 1
ORDER BY qb.Alpha DESC, qb.ScoringKey;
```

**重複上述查詢**，將 TraitCategoryId 改為 8, 34, 156, 162，即可取得所有需要的題目。

## 統計資訊

**待選題完成後填入**：
- 總題數：50
- 正向題數：__ (__%)
- 反向題數：__ (__%)
- 平均 Alpha：__
- 最低 Alpha：__
- 使用的 Instruments 分布：__

## SQL INSERT 指令

### TestPaper INSERT

```sql
INSERT INTO TestPaper (Name, Code, Description, ResponseType, TimeLimit, TotalQuestions, IsActive)
VALUES (
    '大五人格快速評估',
    'BIG5_QUICK_01',
    '全面評估五大人格特質，適合一般人格評估、個人成長、職業規劃',
    'Likert5',
    20,
    50,
    1
);
```

**注意**：執行後記下生成的 Id，用於 TestPaperDetail INSERT。

### TestPaperDetail INSERT

```sql
-- 假設 TestPaper 的 Id 為 1（需根據實際 INSERT 結果調整）
-- 或使用變數：
-- DECLARE @TestPaperId INT;
-- SET @TestPaperId = SCOPE_IDENTITY();

INSERT INTO TestPaperDetail (TestPaperId, QuestionBankId, QuestionOrder, IsRequired)
VALUES
    -- 以下為範例，實際需填入選定的 QuestionBankId
    (1, [QuestionBankId_1], 1, 1),
    (1, [QuestionBankId_2], 2, 1),
    -- ... 共 50 題
    (1, [QuestionBankId_50], 50, 1);
```

**生成 INSERT 指令的方法**：
1. 完成題目清單後，將 QuestionBankId 和順序整理成 CSV
2. 使用 Excel 或文字編輯器的「尋找與取代」功能生成 INSERT 語句
3. 或使用 Python 腳本自動生成（參考 `選題腳本概念.py`）

## 選題檢查清單

- [ ] 確認所有題目的 Alpha >= 0.70
- [ ] 確認每個 trait 都有 10 題
- [ ] 確認每個 trait 都有正向題和反向題
- [ ] 確認正向題與反向題比例約 60-70% : 30-40%
- [ ] 確認題目順序已隨機化
- [ ] 確認沒有重複的 QuestionBankId
- [ ] 確認 5 份測驗之間沒有重複的 QuestionBankId
- [ ] 確認所有題目都有中文翻譯（TextZh）

