# INSERT SQL 執行摘要

## 📋 快速開始

### 1️⃣ 一鍵執行（推薦）

```bash
# 使用 sqlcmd 執行
sqlcmd -S localhost -d PsychometricTestDB -i INSERT_TestPapers.sql
```

### 2️⃣ 使用 SSMS

1. 開啟 `INSERT_TestPapers.sql`
2. 按 F5 執行
3. 查看訊息視窗確認結果

---

## ✅ 執行結果預期

執行成功後，您應該看到：

```
✓ 測驗 1：大五人格快速評估 - 已插入 1 筆測卷 + 50 筆題目
✓ 測驗 2：職場人格評估 - 已插入 1 筆測卷 + 50 筆題目
✓ 測驗 3：情緒與人際關係 - 已插入 1 筆測卷 + 50 筆題目
✓ 測驗 4：創造力與開放性 - 已插入 1 筆測卷 + 50 筆題目
✓ 測驗 5：全面人格評估 - 已插入 1 筆測卷 + 50 筆題目

========================================
驗證資料插入結果
========================================
TestPaper 總筆數: 5 (預期: 5)
TestPaperDetail 總筆數: 250 (預期: 250)

各測卷題數統計:
----------------------------------------
測卷ID  測卷代碼                      測卷名稱          設定題數  實際題數  狀態
1       BIG5_QUICK_01                 大五人格快速評估  50        50        ✓ 正確
2       WORKPLACE_PERSONALITY_01      職場人格評估      50        50        ✓ 正確
3       EMOTION_INTERPERSONAL_01      情緒與人際關係    50        50        ✓ 正確
4       CREATIVITY_OPENNESS_01        創造力與開放性    50        50        ✓ 正確
5       COMPREHENSIVE_PERSONALITY_01  全面人格評估      50        50        ✓ 正確

========================================
資料插入完成！
========================================
```

---

## 📊 資料統計

| 項目 | 數量 |
|------|------|
| 測卷數量 | 5 份 |
| 每份測卷題數 | 50 題 |
| 測卷明細總數 | 250 筆 |
| INSERT 指令總數 | 255 筆 |
| 使用的不重複題目 | 250 題 |

---

## 🔍 快速驗證

```sql
-- 檢查測卷
SELECT Id, Code, Name, TotalQuestions FROM dbo.TestPaper;

-- 檢查第一份測卷的前 5 題
SELECT TOP 5
    tpd.QuestionOrder,
    qb.TextZh,
    tc.NameZh AS TraitName
FROM dbo.TestPaperDetail tpd
INNER JOIN dbo.QuestionBank qb ON tpd.QuestionBankId = qb.Id
INNER JOIN dbo.TraitCategory tc ON qb.TraitCategoryId = tc.Id
WHERE tpd.TestPaperId = 1
ORDER BY tpd.QuestionOrder;
```

---

## ⚠️ 常見問題

### 問題：外鍵約束錯誤
**解決**：確認題庫資料已匯入
```sql
SELECT COUNT(*) FROM dbo.QuestionBank; -- 應該有 3,805 筆
```

### 問題：唯一約束錯誤（重複執行）
**解決**：先刪除舊資料
```sql
DELETE FROM dbo.TestPaper;
DBCC CHECKIDENT ('dbo.TestPaper', RESEED, 0);
DBCC CHECKIDENT ('dbo.TestPaperDetail', RESEED, 0);
```

### 問題：中文亂碼
**解決**：確認 SQL 檔案以 UTF-8 編碼儲存

---

## 📚 詳細文件

- **INSERT_TestPapers.sql** - 完整的 SQL 指令（執行此檔案）
- **INSERT指令說明.md** - 詳細的技術說明
- **README.md** - 完整的使用指南

---

**建立日期**：2024-12-21  
**預計執行時間**：< 1 分鐘  
**狀態**：✅ 可立即執行

